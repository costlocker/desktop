<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>Costlocker!</title>
  </head>
  <body>
    <webview
      id="costlocker"
      src="http://costlocker.php7:8080/" 
      autosize="on"
      preload="./costlocker.js"
    >
    </webview>

    <script>
      require('./renderer.js')
    </script>
    <script>
      onload = () => {
        const webview = document.querySelector('webview');
        webview.addEventListener('did-start-loading', () => {
          console.log('start loading');
        });
        webview.addEventListener('did-stop-loading', () => {
          console.log('Costlocker loaded');
        });
        webview.addEventListener('dom-ready', () => {
          webview.openDevTools();
          setTimeout(
            () => {
              const idleDate = new Date();
              idleDate.setHours(idleDate.getHours() - 2);
              const timestamp = Math.floor(idleDate / 1000);
              webview.executeJavaScript("_clWrapApp_reminderTrackButtonPressed()");
              webview.executeJavaScript("_clWrapApp_idleTimeDetected(" + timestamp + ");");
            },
            2000
          );
        });
        webview.addEventListener('ipc-message', event => {
          console.log(event);
        });
      }
    </script>
    <style>
    body {
      width: 100%;
      height: 100%;
      margin: 0;
      padding: 0;
    }
    webview {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      display: inline-flex !important;
    }
    </style>
  </body>
</html>
